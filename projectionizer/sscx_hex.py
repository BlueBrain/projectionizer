'''SSCX functions related to working w/ hex'''
import numpy as np
import pandas as pd
from voxcell import VoxelData

from projectionizer import sscx
from projectionizer.utils import XYZUVW

VOXEL_SIZE_UM = 10


# from proj1/circuits/SomatosensoryCxS1-v5.r0/O1/merged_circuit/circuit.mvd2
LOCATIONS = np.array([(352.268, 202.034), (340.422, 184.203), (363.994, 216.486),
                      (372.338, 195.883), (321.824, 188.071), (347.074, 229.682),
                      (327.913, 224.298), (316.180, 206.540), (351.366, 168.444),
                      (369.407, 177.818), (324.749, 170.118), (375.946, 230.254),
                      (331.768, 242.944), (306.849, 176.031), (392.859, 197.738),
                      (339.865, 153.699), (299.048, 193.051), (311.000, 234.941),
                      (347.758, 251.248), (361.288, 150.086), (398.264, 177.636),
                      (401.203, 214.631), (292.959, 219.318), (380.231, 249.686),
                      (389.251, 157.117), (314.608, 145.888), (396.799, 237.811),
                      (328.357, 262.296), (290.930, 166.100), (412.028, 191.196),
                      (368.582, 265.524), (350.689, 269.313), (279.203, 180.943),
                      (379.554, 138.076), (274.919, 199.007), (408.194, 161.023),
                      (294.538, 252.029), (420.822, 209.846), (294.087, 144.911),
                      (341.444, 123.917), (280.105, 239.531), (306.264, 266.481),
                      (402.782, 256.716), (311.677, 127.823), (402.331, 140.224),
                      (417.214, 244.218), (385.643, 274.293), (430.188, 193.638),
                      (318.216, 280.249), (358.801, 115.240), (271.311, 158.386),
                      (260.261, 187.583), (368.730, 284.936), (259.042, 211.184),
                      (339.069, 287.806), (262.967, 228.985), (431.865, 173.828),
                      (393.698, 123.980), (431.414, 229.389), (422.852, 150.575),
                      (331.521, 107.122), (255.448, 168.842), (266.124, 256.228),
                      (445.177, 204.378), (382.937, 107.903), (276.497, 128.604),
                      (425.438, 261.344), (357.906, 302.122), (415.636, 277.124),
                      (394.234, 291.962), (254.560, 150.637), (289.351, 111.516),
                      (303.107, 296.068), (449.687, 178.599), (410.223, 115.812),
                      (240.409, 204.977), (278.527, 281.812), (240.416, 186.411),
                      (336.257, 306.809), (242.446, 227.129), (303.558, 100.091),
                      (378.427, 303.977), (352.493, 90.815), (451.717, 231.817),
                      (442.471, 255.154), (316.687, 307.970), (432.993, 127.934),
                      (330.619, 87.983), (448.109, 149.012), (237.033, 165.807),
                      (247.632, 259.841), (258.675, 123.833), (462.943, 193.223),
                      (412.704, 296.556), (258.224, 279.384), (459.772, 163.234),
                      (436.157, 278.980), (465.924, 211.018), (367.426, 80.356),
                      (354.974, 321.554), (283.263, 304.270), (272.431, 102.546),
                      (238.838, 141.201), (425.156, 105.354), (386.771, 83.394),
                      (287.991, 90.731), (406.390, 91.108), (222.375, 189.536),
                      (395.565, 314.523), (452.393, 130.948), (301.754, 319.210),
                      (221.473, 230.938), (339.632, 71.006), (469.758, 241.191),
                      (307.392, 75.582), (329.717, 329.365), (213.581, 208.381),
                      (228.852, 263.224), (480.582, 200.570), (444.501, 108.391),
                      (480.575, 181.249), (384.741, 330.147), (260.486, 305.247),
                      (426.460, 309.934), (478.552, 159.851), (217.189, 249.002),
                      (467.953, 265.797), (249.662, 100.580), (355.876, 61.423),
                      (244.024, 294.213), (453.295, 289.526), (310.457, 335.390),
                      (375.721, 62.595), (430.294, 86.323), (211.551, 155.164),
                      (235.004, 111.028), (205.237, 178.990), (220.797, 131.827),
                      (361.514, 342.743), (277.399, 72.750), (489.595, 223.823),
                      (473.366, 127.139), (310.316, 57.629), (334.227, 53.612),
                      (203.905, 236.499), (485.480, 250.627), (414.508, 68.063),
                      (325.433, 347.430), (264.771, 324.678), (218.767, 278.589),
                      (422.168, 329.477), (394.663, 55.955), (471.336, 286.401),
                      (285.743, 339.618), (454.197, 308.664), (193.510, 220.782),
                      (486.368, 268.832), (194.518, 161.354), (497.044, 156.238),
                      (503.351, 202.536), (256.878, 70.895), (408.419, 344.305),
                      (188.880, 195.140), (300.176, 352.117), (376.841, 43.373),
                      (466.149, 94.330), (374.417, 357.965), (278.633, 54.236),
                      (228.013, 89.643), (200.494, 129.399), (191.932, 250.565),
                      (483.168, 111.359), (455.325, 78.707), (214.257, 104.388),
                      (200.945, 273.818), (184.716, 177.134), (507.417, 228.594),
                      (493.887, 128.995), (393.987, 356.804), (350.464, 36.035),
                      (509.447, 181.822), (437.284, 63.083), (337.835, 364.518),
                      (267.075, 344.685), (224.631, 312.863), (502.231, 258.376),
                      (294.763, 40.820), (329.041, 33.399), (236.808, 327.022),
                      (441.055, 338.704), (491.181, 287.573), (186.294, 144.228),
                      (359.484, 369.205), (236.357, 69.919), (281.007, 358.659),
                      (248.534, 341.474), (472.238, 318.038), (309.696, 30.361),
                      (404.811, 36.524), (253.947, 52.830), (520.271, 211.506),
                      (460.512, 331.709), (304.340, 370.122), (511.025, 139.541),
                      (365.122, 25.587), (170.960, 223.126), (433.676, 355.242),
                      (430.625, 42.030), (166.675, 203.694), (177.274, 261.013),
                      (171.862, 156.726), (479.898, 79.502), (189.902, 109.856),
                      (500.201, 105.169), (386.996, 23.829), (327.011, 380.142),
                      (196.217, 302.805), (527.791, 182.232), (510.123, 280.933),
                      (167.598, 240.991), (387.447, 379.360), (525.007, 244.901),
                      (267.477, 32.911), (253.270, 359.929), (525.458, 152.039),
                      (216.061, 332.099), (495.014, 313.058), (456.904, 48.925),
                      (207.041, 74.703), (521.850, 266.090), (534.478, 200.081),
                      (409.998, 377.017), (345.954, 388.344), (181.108, 291.186),
                      (225.533, 54.295), (281.987, 21.799), (317.991, 12.600),
                      (456.453, 354.265), (190.804, 91.499), (199.148, 320.870),
                      (270.120, 374.736), (287.322, 381.704), (225.984, 348.895),
                      (154.723, 174.303), (368.046, 7.634), (537.184, 166.491),
                      (336.933, 5.960), (298.146, 11.428), (407.510, 14.860),
                      (523.879, 119.328), (167.344, 277.626), (170.283, 114.641),
                      (446.981, 32.129), (484.190, 59.959), (158.331, 257.107),
                      (437.961, 374.673), (303.784, 392.738), (430.068, 20.900),
                      (542.597, 227.813), (520.497, 295.677), (159.233, 131.338),
                      (330.048, 399.123), (362.634, 399.392), (520.948, 101.263),
                      (383.163, 397.425), (180.480, 313.438), (148.634, 238.066),
                      (391.957, 3.617), (498.397, 332.881), (401.647, 394.216),
                      (531.554, 281.349), (508.770, 78.902), (149.311, 149.696),
                      (549.136, 180.259), (202.756, 55.272), (264.094, 13.088),
                      (248.978, 379.472), (545.528, 245.878), (187.647, 71.090),
                      (229.592, 31.739), (141.644, 211.311), (421.724, 391.469),
                      (541.730, 265.146), (541.920, 134.951), (484.867, 352.800),
                      (479.454, 41.504), (281.621, 3.386), (137.810, 184.946),
                      (200.727, 350.457), (241.318, 18.068), (210.135, 38.734),
                      (467.728, 27.052), (555.500, 160.914), (427.137, 2.835),
                      (270.183, 399.280), (133.976, 167.272), (210.050, 366.393),
                      (132.250, 229.200), (440.265, 394.680), (562.441, 207.112),
                      (224.405, 378.677), (455.551, 12.893), (561.194, 229.804),
                      (476.748, 375.064), (458.933, 389.613), (249.119, 1.049),
                      (235.229, 394.300), (569.989, 187.816), (228.239, 5.081),
                      (117.733, 197.166), (-1.851, 403.353), (-0.159, 385.655),
                      (12.469, 413.387), (-19.102, 395.420), (16.979, 387.608),
                      (-9.180, 421.198), (-26.036, 413.924), (-0.949, 363.514),
                      (35.922, 412.215), (-25.416, 370.031), (-38.045, 389.951),
                      (24.647, 431.646), (41.334, 394.638), (-20.004, 436.822),
                      (8.748, 441.143), (-37.143, 429.791), (31.750, 363.318),
                      (13.371, 353.236), (-47.967, 414.168), (45.393, 377.355),
                      (-8.556, 451.254), (42.236, 434.478), (-16.396, 344.643),
                      (-58.791, 390.733), (-35.846, 447.929), (28.706, 454.398),
                      (63.434, 403.915), (9.763, 464.163), (-21.808, 462.210),
                      (-48.869, 355.580), (-54.281, 438.775), (38.628, 345.425),
                      (-60.144, 370.324), (-66.346, 412.825), (9.312, 332.047),
                      (62.983, 433.697), (62.532, 362.513), (-12.337, 327.360),
                      (-40.751, 337.613), (50.016, 457.742), (75.611, 382.530),
                      (-71.532, 430.597), (-45.261, 463.382), (-75.930, 377.843),
                      (81.305, 401.815), (20.587, 479.786), (-83.033, 397.495),
                      (81.024, 424.323), (-63.301, 343.081), (-68.714, 451.273),
                      (-15.494, 484.473), (32.314, 320.036), (57.571, 335.660),
                      (-32.294, 318.792), (-33.083, 481.641), (78.656, 442.998),
                      (-87.656, 421.979), (68.395, 459.085), (-12.788, 310.272),
                      (81.926, 357.923), (-51.462, 321.330), (37.726, 486.817),
                      (8.861, 305.585), (-84.048, 350.112), (-62.399, 476.661),
                      (60.277, 481.348), (-4.669, 501.659), (27.465, 301.899),
                      (13.428, 501.220), (-48.982, 491.138), (80.911, 334.903),
                      (59.826, 314.861), (102.785, 381.481), (104.476, 401.278),
                      (-104.795, 409.090), (-77.227, 328.483), (-105.246, 387.901),
                      (-93.971, 449.711), (-44.359, 303.241), (100.417, 361.341),
                      (100.868, 441.899), (2.096, 289.864), (85.534, 471.974),
                      (77.528, 317.424), (-106.035, 359.705), (110.791, 426.666),
                      (43.928, 505.589), (-15.043, 286.348), (-72.773, 311.346),
                      (-72.322, 491.894), (26.451, 514.060), (100.361, 461.209),
                      (50.354, 293.477), (-33.985, 513.279), (-92.166, 474.318),
                      (-97.579, 332.535), (-117.874, 420.319), (-117.423, 375.890),
                      (-52.477, 508.690), (120.262, 412.508), (97.260, 327.848),
                      (-33.534, 282.931), (120.713, 383.702), (117.499, 365.515),
                      (69.921, 298.925), (-116.521, 440.728), (-52.928, 287.520),
                      (-124.978, 404.232), (-10.984, 526.266), (91.735, 488.013),
                      (31.412, 275.119), (114.399, 340.738), (61.179, 513.767),
                      (11.454, 271.238), (-91.264, 307.928), (-73.675, 292.988),
                      (78.317, 504.784), (-113.421, 465.505), (-73.224, 509.471),
                      (-5.571, 268.089), (89.142, 300.117), (10.665, 534.078),
                      (-30.885, 532.588), (-130.559, 361.219), (-133.660, 427.838),
                      (113.497, 475.880), (66.591, 280.587), (133.341, 432.525),
                      (113.046, 320.329), (37.839, 533.028), (-110.207, 483.692),
                      (124.885, 459.695), (-52.026, 528.902), (139.656, 407.918),
                      (-120.129, 326.676), (-110.658, 312.518), (138.754, 374.328),
                      (-141.778, 400.107), (-130.052, 341.909), (105.942, 304.242),
                      (-99.383, 504.002), (-130.503, 461.331), (-56.649, 266.844),
                      (56.669, 265.745), (136.949, 349.721), (-74.577, 526.559),
                      (95.456, 511.814), (-39.849, 257.543), (-145.386, 371.984),
                      (27.804, 546.967), (-22.541, 251.952), (-74.126, 269.651),
                      (100.925, 287.569), (-92.054, 520.529), (39.530, 252.856),
                      (14.273, 248.169), (117.105, 497.753), (132.778, 475.807),
                      (-34.436, 549.310), (-150.009, 434.893), (-153.392, 417.414),
                      (67.493, 539.155), (146.872, 450.102), (126.125, 309.100),
                      (77.415, 264.964), (86.436, 529.391), (-134.957, 478.468),
                      (-13.802, 555.584), (153.693, 428.473), (-7.376, 243.482),
                      (158.147, 411.336), (158.598, 391.904), (5.253, 558.685),
                      (-102.089, 278.244), (-126.895, 495.703), (-133.773, 312.640),
                      (-69.616, 543.842), (-148.994, 457.913), (53.061, 551.654),
                      (96.358, 270.432), (-162.352, 396.864), (-152.264, 343.008),
                      (143.264, 321.989), (-112.575, 519.553), (135.709, 494.067),
                      (-91.152, 261.961), (-127.346, 293.867), (-55.183, 556.341),
                      (63.998, 246.338), (125.223, 289.180), (-162.525, 359.095),
                      (-149.896, 324.333), (31.299, 565.349), (24.196, 232.936),
                      (162.206, 351.283), (49.058, 237.867), (-55.634, 239.869),
                      (168.521, 376.671), (-170.643, 381.358), (-171.094, 414.851),
                      (103.011, 537.910), (-102.991, 538.374), (167.619, 443.071),
                      (-26.769, 571.086), (154.990, 477.833), (159.388, 330.607),
                      (-83.146, 245.044), (-155.309, 482.520), (16.190, 575.211),
                      (-26.318, 225.124), (-173.349, 435.650), (82.377, 556.634),
                      (135.145, 514.939), (-131.856, 519.626), (146.534, 298.774),
                      (-149.615, 301.825), (66.478, 566.130), (-77.734, 561.809),
                      (-168.388, 462.503), (-108.403, 255.980), (124.321, 530.562),
                      (-167.937, 333.707), (179.458, 421.320), (118.909, 263.792),
                      (-132.307, 276.584), (-94.873, 554.779), (46.746, 576.261),
                      (-62.794, 572.209), (105.829, 250.024), (-1.061, 215.750),
                      (170.776, 470.314), (89.480, 238.331), (-180.904, 357.752),
                      (71.101, 228.249), (-148.882, 511.936), (186.561, 403.231),
                      (-186.541, 404.330), (-1.512, 586.709), (176.639, 338.785),
                      (144.166, 279.416), (99.966, 559.466), (52.159, 218.094),
                      (185.659, 363.392), (-47.065, 584.073), (182.051, 455.570),
                      (-130.954, 259.496), (-34.549, 209.916), (17.881, 207.548),
                      (-193.194, 386.827), (190.169, 437.603), (164.010, 296.211),
                      (172.129, 490.723), (-76.832, 220.437), (-125.091, 549.994),
                      (154.088, 520.407), (-160.721, 288.399), (-143.639, 534.541),
                      (-166.133, 505.955), (-192.292, 445.415), (-18.200, 202.861),
                      (-57.889, 210.672), (122.517, 555.950), (-180.115, 316.814),
                      (-112.011, 563.762), (197.837, 381.651), (167.224, 507.371),
                      (-172.391, 300.849), (136.047, 254.809), (-29.926, 596.962),
                      (-86.754, 579.386), (198.626, 418.782), (-198.606, 420.026),
                      (-188.684, 334.488), (-106.599, 230.592), (38.233, 203.495),
                      (112.482, 233.741), (23.294, 599.305), (-185.527, 477.345),
                      (70.199, 588.369), (98.613, 576.554), (-203.455, 401.889),
                      (64.787, 205.985), (-159.819, 528.219), (82.038, 211.966),
                      (99.064, 219.656), (54.075, 599.037), (-148.543, 256.664),
                      (147.774, 545.014), (-202.214, 354.408), (-66.910, 596.181),
                      (-95.775, 214.969), (-141.665, 554.120), (-136.253, 240.479),
                      (-210.333, 379.796), (-128.755, 567.839), (211.540, 391.884),
                      (208.661, 441.020), (-210.953, 436.187), (-82.752, 201.079),
                      (-84.386, 598.744), (83.451, 599.286), (-105.697, 589.150),
                      (218.132, 410.262), (103.574, 593.837), (128.831, 578.214),
                      (95.178, 200.497), (-124.189, 216.434), (-222.059, 405.575),
                      (-122.888, 586.494), (-109.700, 200.371), (355.086, 586.462),
                      (330.731, 604.429), (349.673, 618.880), (366.812, 612.240),
                      (321.710, 589.977), (345.248, 572.395), (378.538, 587.634),
                      (365.910, 570.838), (317.708, 624.080), (309.477, 606.626),
                      (383.951, 605.210), (329.829, 563.027), (334.339, 638.800),
                      (374.930, 634.504), (311.619, 571.449), (301.866, 585.681),
                      (355.988, 646.612), (348.151, 552.017), (384.853, 565.370),
                      (395.677, 580.994), (395.226, 622.298), (370.927, 551.431),
                      (292.845, 621.224), (326.221, 655.205), (406.501, 601.304),
                      (285.009, 603.184), (300.964, 644.269), (295.551, 561.074),
                      (359.596, 535.686), (387.418, 547.202), (320.808, 537.639),
                      (282.923, 573.963), (388.461, 654.424), (337.947, 530.999),
                      (350.575, 671.219), (301.020, 543.912), (309.082, 662.235),
                      (414.620, 626.692), (403.795, 553.262), (414.169, 569.569),
                      (331.717, 672.775), (277.511, 631.379), (375.889, 529.461),
                      (269.900, 588.927), (424.739, 597.758), (375.438, 674.075),
                      (409.207, 652.080), (281.119, 548.575), (264.431, 613.705),
                      (399.736, 532.073), (327.123, 515.375), (396.523, 671.561),
                      (291.943, 668.875), (308.180, 520.843), (353.281, 511.079),
                      (317.200, 684.499), (434.915, 614.486), (266.517, 558.559),
                      (337.045, 689.576), (435.366, 582.556), (253.776, 599.107),
                      (254.960, 577.869), (422.343, 544.401), (265.784, 649.737),
                      (358.694, 694.264), (431.758, 641.925), (387.559, 513.032),
                      (287.433, 523.187), (414.225, 670.169), (392.069, 688.795),
                      (247.772, 618.899), (371.830, 502.217), (251.859, 635.798),
                      (272.493, 671.072), (410.109, 518.500), (446.698, 631.111),
                      (317.398, 498.940), (344.712, 705.102), (443.485, 557.949),
                      (352.379, 493.502), (262.176, 532.561), (454.309, 598.570),
                      (298.258, 696.607), (283.430, 687.746), (428.150, 527.874),
                      (248.646, 550.137), (236.017, 602.085), (437.621, 663.700),
                      (448.051, 648.199), (367.319, 710.790), (398.383, 498.971),
                      (236.919, 568.495), (443.090, 538.932), (298.709, 494.576),
                      (252.254, 667.313), (392.971, 706.372), (460.623, 573.182),
                      (463.329, 616.146), (328.025, 482.957), (270.295, 507.954),
                      (316.298, 716.917), (421.385, 696.119), (225.193, 623.958),
                      (233.311, 651.299), (284.332, 707.665), (471.194, 589.068),
                      (467.445, 634.626), (364.106, 475.145), (380.793, 478.562),
                      (258.568, 691.920), (351.477, 727.073), (464.231, 551.309),
                      (219.781, 581.384), (343.190, 471.849), (420.934, 495.065),
                      (381.244, 724.729), (224.319, 555.233), (450.701, 681.374),
                      (240.979, 519.574), (456.113, 523.968), (328.983, 732.565),
                      (269.393, 490.378), (305.981, 471.752), (288.335, 478.269),
                      (481.652, 609.824), (225.700, 537.761), (438.974, 699.732),
                      (445.571, 505.147), (229.703, 673.172), (291.041, 726.292),
                      (366.897, 736.441), (208.054, 599.742), (416.424, 719.261),
                      (400.469, 728.171), (467.839, 668.485), (212.170, 638.922),
                      (259.470, 709.496), (415.973, 477.781), (483.174, 567.323),
                      (250.450, 495.846), (479.566, 650.127), (391.449, 464.526),
                      (489.488, 591.930), (206.701, 563.710), (319.906, 457.568),
                      (235.623, 694.776), (212.565, 657.939), (309.984, 742.306),
                      (370.420, 452.881), (445.289, 488.034), (228.801, 506.782),
                      (493.096, 632.551), (482.779, 535.808), (340.653, 448.976),
                      (197.230, 627.864), (268.491, 730.197), (356.890, 751.680),
                      (195.172, 580.084), (466.486, 694.947), (389.363, 746.993),
                      (501.215, 607.944), (190.916, 600.132), (417.326, 460.693),
                      (475.507, 511.762), (200.838, 541.935), (335.241, 756.367),
                      (248.730, 475.920), (281.542, 744.033), (466.035, 496.236),
                      (280.217, 456.006), (496.704, 549.747), (233.931, 487.790),
                      (408.305, 746.211), (427.981, 736.276), (455.944, 715.184),
                      (503.413, 571.082), (485.880, 677.859), (263.078, 462.646),
                      (191.423, 644.391), (240.528, 721.605), (402.893, 448.194),
                      (497.437, 658.549), (437.170, 464.990), (312.408, 759.247),
                      (222.487, 705.981), (360.103, 437.380), (446.191, 729.416),
                      (186.857, 561.757), (204.446, 682.546), (294.649, 443.507),
                      (203.995, 514.496), (251.352, 737.228), (294.198, 759.784),
                      (179.189, 618.490), (178.738, 584.802), (514.350, 587.756),
                      (374.028, 766.912), (475.056, 710.668), (351.083, 769.769),
                      (385.755, 432.962), (495.351, 513.715), (512.039, 648.565),
                      (455.380, 465.820), (323.063, 428.567), (518.353, 623.177),
                      (266.686, 754.804), (239.626, 461.474), (171.466, 602.329),
                      (508.431, 531.389), (323.514, 774.724), (501.186, 686.128),
                      (177.893, 544.791), (183.249, 669.559), (272.099, 438.039),
                      (183.700, 526.702), (489.996, 493.624), (522.863, 568.885),
                      (348.320, 420.756), (306.376, 425.150), (473.703, 727.756),
                      (168.816, 632.063), (205.348, 712.621), (169.267, 564.198),
                      (210.761, 480.222), (420.088, 434.548), (193.819, 697.748),
                      (432.660, 759.491), (172.875, 653.252), (234.213, 743.868),
                      (474.154, 469.286), (401.709, 425.687), (529.178, 596.617),
                      (513.843, 673.953), (247.744, 445.070), (221.585, 464.599),
                      (341.555, 784.098), (413.718, 771.600), (287.941, 424.881),
                      (293.747, 777.068), (457.297, 748.091), (186.349, 506.343),
                      (161.149, 588.805), (396.128, 778.923), (442.583, 440.383),
                      (506.176, 499.654), (386.262, 414.726), (193.622, 487.253),
                      (156.639, 613.022), (506.627, 703.638), (531.433, 652.764),
                      (313.874, 409.453), (367.714, 792.301), (531.884, 544.279),
                      (539.100, 620.833), (273.001, 779.411), (523.765, 521.234),
                      (211.663, 740.353), (265.164, 422.342), (452.505, 764.569),
                      (465.133, 443.898), (175.130, 695.728), (478.664, 745.040),
                      (519.763, 692.823), (312.239, 794.156), (540.002, 562.245),
                      (243.234, 769.256), (503.921, 479.441), (181.896, 711.449),
                      (228.745, 760.224), (164.757, 680.984), (412.816, 411.479),
                      (329.237, 799.032), (503.470, 723.850), (226.997, 439.211),
                      (387.953, 796.060), (242.783, 427.786), (494.055, 463.061),
                      (193.340, 731.125), (201.740, 459.521), (548.120, 584.509),
                      (536.394, 670.047), (424.542, 787.223), (153.933, 665.360),
                      (407.403, 793.863), (143.193, 591.143), (470.546, 761.444),
                      (441.681, 780.192), (496.535, 739.401), (143.616, 568.617),
                      (294.368, 799.868), (436.268, 412.651), (288.307, 400.219),
                      (551.728, 637.629), (140.402, 645.440), (204.531, 756.751),
                      (482.272, 437.258), (275.256, 799.624), (558.043, 615.365),
                      (259.076, 793.594), (132.284, 620.052), (244.136, 410.698),
                      (471.448, 421.635), (562.637, 572.785), (214.820, 773.845),
                      (127.323, 602.769), (473.195, 778.581), (453.407, 406.011),
                      (567.965, 589.586), (452.956, 797.281), (235.115, 796.206),
                      (680.940, 394.053), (686.353, 411.630), (702.589, 389.366),
                      (707.776, 407.821), (675.979, 376.770), (723.674, 398.569),
                      (701.687, 430.768), (675.416, 429.328), (719.622, 378.761),
                      (659.179, 411.752), (696.275, 363.978), (657.488, 380.383),
                      (677.332, 359.682), (731.454, 420.613), (689.179, 444.184),
                      (718.826, 438.190), (741.377, 396.397), (713.414, 354.995),
                      (736.641, 376.575), (642.153, 406.161), (668.312, 446.001),
                      (648.467, 428.425), (707.438, 452.080), (659.743, 356.850),
                      (640.236, 385.973), (692.216, 342.789), (750.397, 410.849),
                      (692.667, 460.844), (742.279, 436.237), (639.447, 364.759),
                      (726.831, 454.716), (629.525, 418.270), (761.221, 384.289),
                      (758.804, 426.950), (650.046, 457.816), (738.670, 344.058),
                      (624.113, 376.477), (715.218, 330.388), (673.724, 470.608),
                      (753.103, 356.557), (678.911, 326.580), (617.798, 400.693),
                      (769.340, 408.505), (629.976, 444.732), (644.859, 339.371),
                      (661.892, 328.766), (706.197, 478.420), (744.083, 461.625),
                      (758.515, 449.126), (724.809, 477.091), (733.709, 326.775),
                      (697.177, 314.764), (611.484, 427.644), (607.545, 386.084),
                      (684.549, 486.232), (634.035, 465.921), (772.722, 437.506),
                      (608.440, 365.565), (626.255, 337.638), (777.007, 364.271),
                      (782.306, 380.993), (782.757, 422.298), (676.043, 308.114),
                      (661.096, 488.185), (643.957, 480.763), (762.123, 331.950),
                      (606.748, 445.318), (724.802, 308.149), (790.086, 403.037),
                      (756.711, 473.733), (595.248, 407.724), (708.452, 498.633),
                      (614.528, 463.407), (726.042, 495.996), (655.684, 305.000),
                      (605.170, 347.183), (744.872, 489.088), (708.001, 297.579),
                      (628.397, 318.768), (751.073, 314.081), (776.337, 461.541),
                      (683.083, 504.028), (588.933, 381.945), (686.127, 293.770),
                      (799.445, 387.633), (785.576, 342.496), (790.988, 450.688),
                      (583.521, 423.738), (799.396, 433.980), (801.587, 368.763),
                      (643.344, 501.942), (627.721, 493.653), (668.876, 288.229),
                      (807.225, 415.926), (735.964, 292.110), (657.262, 512.499),
                      (774.301, 313.495), (572.697, 401.865), (784.674, 477.639),
                      (577.883, 364.076), (690.412, 520.506), (718.946, 282.091),
                      (632.231, 294.454), (587.580, 463.089), (570.780, 384.020),
                      (816.245, 399.131), (603.817, 314.276), (588.031, 334.294),
                      (806.323, 351.089), (690.863, 276.096), (722.208, 520.310),
                      (763.927, 503.417), (754.907, 289.767), (797.303, 326.482),
                      (599.532, 487.501), (575.403, 451.079), (566.383, 426.472),
                      (779.938, 495.313), (626.819, 511.229), (674.626, 528.024),
                      (642.604, 279.514), (818.951, 434.284), (745.436, 519.724),
                      (818.500, 363.099), (662.900, 272.191), (808.803, 464.066),
                      (643.055, 524.118), (727.846, 267.503), (615.092, 287.033),
                      (601.061, 296.860), (830.452, 387.511), (658.051, 535.079),
                      (570.667, 468.753), (553.754, 377.649), (560.068, 350.698),
                      (834.737, 414.266), (757.162, 272.483), (704.393, 256.958),
                      (814.441, 323.748), (576.305, 315.936), (549.018, 395.323),
                      (775.203, 281.858), (603.366, 513.182), (554.656, 442.486),
                      (717.811, 542.598), (625.917, 271.409), (585.325, 499.121),
                      (573.944, 486.270), (618.369, 526.695), (665.162, 255.116),
                      (562.436, 330.022), (803.617, 301.875), (682.745, 252.271),
                      (645.761, 259.301), (698.981, 548.725), (744.534, 259.594),
                      (543.381, 413.485), (804.068, 500.586), (836.090, 447.173),
                      (819.853, 481.935), (783.772, 520.994), (545.417, 361.551),
                      (744.985, 543.257), (792.792, 284.689), (597.954, 280.002),
                      (669.214, 552.631), (837.668, 345.328), (767.535, 537.789),
                      (845.448, 363.417), (580.815, 288.986), (636.741, 547.944),
                      (685.119, 559.895), (546.087, 464.261), (839.360, 465.555),
                      (532.000, 397.509), (556.798, 313.422), (729.650, 242.897),
                      (733.322, 556.819), (826.168, 307.734), (551.386, 480.983),
                      (541.802, 337.516), (714.992, 562.494), (706.761, 236.281),
                      (563.451, 501.562), (615.994, 545.601), (531.203, 431.940),
                      (621.181, 251.587), (658.841, 238.502), (772.948, 255.395),
                      (808.691, 518.284), (858.641, 393.663), (842.404, 327.654),
                      (592.316, 532.809), (859.317, 418.758), (647.002, 561.834),
                      (857.175, 437.628), (784.117, 542.124), (525.791, 373.743),
                      (759.417, 555.756), (558.264, 295.626), (635.613, 239.088),
                      (604.162, 253.773), (801.362, 267.015), (587.129, 264.379),
                      (754.005, 238.991), (664.478, 570.305), (527.595, 349.136),
                      (688.157, 226.883), (520.153, 414.071), (830.678, 505.370),
                      (825.265, 287.814), (568.187, 521.384), (700.785, 574.113),
                      (801.813, 536.617), (864.955, 365.931), (629.412, 564.080),
                      (843.306, 492.481), (860.896, 344.742), (681.962, 576.983),
                      (513.952, 389.098), (748.142, 570.501), (538.420, 308.515),
                      (855.033, 476.467), (522.183, 456.547), (720.630, 222.196),
                      (560.639, 276.720), (644.810, 224.309), (732.356, 578.019),
                      (530.301, 484.279), (874.877, 380.773), (776.556, 563.177),
                      (513.163, 361.635), (670.116, 217.508), (590.737, 553.412),
                      (824.363, 529.196), (848.718, 300.703), (739.241, 220.867),
                      (569.089, 261.254), (860.445, 318.280), (574.501, 544.429),
                      (538.871, 506.444), (771.144, 230.007), (875.779, 439.361),
                      (521.281, 322.967), (788.282, 237.038), (870.367, 464.749),
                      (610.582, 570.989), (507.750, 444.048), (703.491, 209.306),
                      (602.013, 231.863), (502.789, 426.765), (805.421, 244.459),
                      (557.362, 537.008), (880.966, 357.826), (687.255, 593.252),
                      (800.009, 561.224), (623.210, 219.071), (886.604, 404.990),
                      (544.396, 525.315), (581.717, 239.772), (712.850, 593.862),
                      (860.452, 499.721), (821.657, 253.442), (660.081, 592.593),
                      (765.506, 582.804), (841.502, 271.019), (722.892, 205.121),
                      (628.623, 586.612), (760.319, 214.384), (495.122, 396.006),
                      (871.156, 485.963), (646.663, 206.963), (681.843, 201.494),
                      (749.495, 590.909), (892.016, 388.195), (879.387, 328.435),
                      (493.889, 377.101), (854.130, 519.041), (732.927, 596.610),
                      (831.467, 545.332), (869.077, 302.255), (859.543, 286.642),
                      (791.559, 576.690), (583.408, 571.111), (740.475, 202.276),
                      (641.251, 598.720), (895.624, 435.065), (890.663, 456.840),
                      (891.227, 343.985), (818.049, 564.349), (799.107, 221.414),
                      (556.242, 556.844), (583.972, 222.488), (840.269, 252.113),
                      (610.927, 592.119), (903.742, 412.020), (618.249, 201.787),
                      (823.236, 232.839), (594.345, 587.784), (777.352, 203.778),
                      (904.644, 370.618), (477.983, 404.209), (599.758, 205.400),
                      (789.184, 595.596), (794.371, 201.592), (915.469, 386.242),
                      (811.735, 588.956), (811.284, 208.427), (583.359, 200.507),
                      (921.170, 403.514), (3.814, 807.168), (-16.538, 794.547),
                      (19.544, 789.860), (5.506, 775.457), (-21.950, 812.124),
                      (-12.478, 777.459), (-9.716, 825.526), (15.541, 823.963),
                      (28.564, 804.312), (-35.931, 798.160), (3.307, 838.683),
                      (-12.930, 760.176), (32.172, 769.940), (-13.381, 842.296),
                      (8.719, 755.489), (41.700, 818.495), (-33.225, 831.750),
                      (46.633, 800.400), (-45.403, 813.295), (-32.774, 765.253),
                      (37.584, 836.730), (21.855, 847.789), (-50.815, 780.877),
                      (57.429, 785.564), (-18.060, 741.745), (-29.166, 854.307),
                      (-51.097, 837.267), (-0.301, 735.569), (12.327, 863.290),
                      (-65.191, 818.202), (60.135, 831.262), (-53.972, 757.539),
                      (68.253, 808.999), (-68.855, 801.187), (41.192, 744.552),
                      (59.684, 764.960), (25.463, 733.738), (-38.186, 739.865),
                      (35.780, 862.119), (-9.321, 871.102), (54.328, 852.476),
                      (76.541, 770.184), (81.389, 788.810), (-81.315, 787.761),
                      (59.599, 743.155), (-76.466, 768.891), (-7.010, 716.552),
                      (-72.464, 841.808), (-25.558, 719.945), (-42.189, 873.958),
                      (24.505, 881.745), (45.252, 727.464), (-59.384, 861.826),
                      (-62.006, 739.615), (24.956, 715.258), (-20.146, 886.725),
                      (48.014, 875.521), (88.098, 816.420), (-91.688, 801.724),
                      (64.786, 866.384), (-1.823, 892.902), (79.078, 849.620),
                      (-81.484, 752.364), (-92.308, 824.232), (92.214, 835.681),
                      (-97.720, 782.439), (97.118, 777.752), (-60.286, 720.433),
                      (-93.926, 765.624), (44.800, 710.181), (75.470, 732.444),
                      (89.000, 750.020), (14.131, 698.072), (-90.673, 848.863),
                      (-38.468, 896.246), (-54.423, 888.678), (-76.072, 727.757),
                      (104.786, 795.035), (-24.628, 696.504), (-49.011, 705.494),
                      (-7.517, 693.385), (62.390, 712.622), (33.384, 697.334),
                      (-85.092, 866.415), (5.111, 908.598), (80.882, 874.227),
                      (-109.898, 804.019), (53.821, 896.490), (104.955, 758.369),
                      (40.008, 906.792), (-110.349, 833.606), (23.603, 913.383),
                      (104.335, 851.182), (113.355, 825.794), (-110.800, 762.617),
                      (52.468, 694.655), (-40.385, 689.211), (-80.976, 885.676),
                      (93.341, 727.000), (-31.421, 914.164), (117.865, 781.267),
                      (119.246, 806.747), (14.582, 680.984), (-55.325, 906.255),
                      (-104.937, 858.994), (-65.557, 698.530), (-11.520, 920.438),
                      (83.080, 711.011), (-105.388, 738.010), (101.347, 872.420),
                      (-96.649, 720.189), (33.976, 677.371), (73.665, 903.911),
                      (-26.460, 675.028), (-0.019, 671.439), (-130.194, 791.813),
                      (-84.190, 700.025), (-130.645, 811.440), (125.532, 838.000),
                      (-129.573, 772.430), (125.983, 759.004), (19.121, 932.125),
                      (100.275, 711.450), (46.605, 926.175), (120.120, 862.607),
                      (-126.585, 751.192), (134.271, 820.179), (-77.876, 911.723),
                      (100.726, 891.803), (-61.188, 677.860), (136.808, 799.625),
                      (-43.683, 670.213), (-1.654, 936.818), (-94.112, 899.615),
                      (82.686, 690.261), (120.571, 733.616), (65.491, 921.048),
                      (-125.965, 858.359), (-117.565, 725.804), (-113.055, 881.257),
                      (-62.034, 925.125), (-137.579, 826.990), (52.017, 667.997),
                      (-47.207, 933.986), (17.740, 657.451), (-27.362, 941.407),
                      (-84.500, 682.516), (-109.841, 704.444), (100.557, 694.191),
                      (86.801, 918.094), (36.147, 657.616), (-147.952, 804.239),
                      (-18.342, 652.764), (140.247, 748.873), (145.828, 766.425),
                      (79.529, 673.173), (-141.920, 850.010), (149.944, 785.686),
                      (-58.031, 660.576), (23.152, 949.219), (50.269, 943.190),
                      (136.994, 865.614), (151.691, 810.659), (-150.038, 774.237),
                      (-138.706, 735.691), (-75.790, 666.752), (121.022, 704.029),
                      (-133.802, 877.742), (70.057, 938.283), (-86.896, 929.299),
                      (2.405, 956.250), (133.200, 882.429), (-156.973, 789.787),
                      (154.848, 827.747), (64.645, 655.889), (138.612, 724.242),
                      (-43.599, 648.077), (149.436, 852.354), (-155.450, 832.434),
                      (-112.153, 913.676), (-151.842, 749.630), (1.954, 639.973),
                      (-106.741, 680.496), (-125.232, 900.103), (-67.051, 946.095),
                      (-44.050, 955.176), (122.375, 905.864), (-124.781, 696.120),
                      (98.922, 669.560), (-27.757, 961.449), (50.213, 643.390),
                      (111.551, 921.488), (-142.822, 716.430), (-95.916, 664.873),
                      (93.510, 937.111), (-104.006, 932.418), (158.456, 741.818),
                      (-168.530, 812.612), (154.454, 868.881), (-166.134, 766.394),
                      (-154.379, 870.174), (127.787, 688.308), (26.760, 632.063),
                      (-72.633, 644.196), (170.634, 820.423), (79.895, 952.216),
                      (168.914, 839.605), (-149.531, 888.800), (30.819, 971.190),
                      (-23.754, 627.376), (-125.373, 678.586), (61.037, 963.671),
                      (146.335, 896.612), (171.536, 761.836), (-143.132, 697.358),
                      (151.748, 710.303), (-11.125, 976.170), (-171.321, 843.145),
                      (117.358, 667.656), (176.497, 788.688), (-177.099, 796.500),
                      (-56.622, 630.233), (89.902, 644.953), (66.449, 630.501),
                      (181.909, 805.484), (-5.713, 618.002), (-36.777, 978.245),
                      (-61.639, 971.483), (-176.592, 752.486), (-171.236, 864.950),
                      (-99.525, 953.906), (-90.504, 640.266), (-132.392, 927.078),
                      (-170.785, 731.272), (12.271, 616.001), (10.523, 983.981),
                      (137.259, 923.148), (-182.906, 775.531), (148.252, 689.626),
                      (47.056, 620.053), (176.948, 857.529), (-162.667, 709.009),
                      (-122.470, 941.530), (-185.668, 827.454), (95.314, 961.718),
                      (173.847, 728.367), (185.884, 771.277), (-144.626, 679.324),
                      (115.666, 949.341), (-86.389, 968.089), (115.610, 649.737),
                      (-115.254, 649.371), (-189.559, 808.071), (-46.756, 615.366),
                      (135.060, 665.483), (167.477, 892.975), (-153.646, 914.848),
                      (185.968, 749.337), (-173.491, 885.554), (-135.606, 661.748),
                      (30.368, 991.402), (-189.728, 844.542), (-74.268, 619.565),
                      (56.076, 986.813), (85.843, 623.959), (-2.500, 995.821),
                      (192.734, 839.855), (156.652, 919.535), (180.105, 880.867),
                      (-55.720, 990.353), (140.416, 940.236), (-195.140, 762.129),
                      (-10.699, 601.322), (86.294, 979.294), (198.597, 784.099),
                      (-164.753, 686.892), (-93.661, 623.178), (-183.132, 715.966),
                      (-201.849, 793.107), (69.099, 610.142), (-141.018, 944.923),
                      (-34.578, 999.214), (-171.405, 908.525), (-193.336, 736.740),
                      (-79.680, 987.106), (195.158, 861.484), (-193.787, 865.731),
                      (-110.067, 972.581), (-154.503, 665.103), (112.002, 627.865),
                      (-157.508, 932.052), (205.362, 819.935), (-205.964, 815.248),
                      (105.547, 978.556), (-205.457, 833.728), (73.271, 998.946),
                      (-137.410, 637.141), (135.004, 964.843), (209.918, 836.961),
                      (213.988, 802.090), (-119.369, 621.518), (-103.133, 988.278),
                      (-131.998, 969.530), (105.067, 612.168), (-214.985, 778.924),
                      (-103.584, 607.945), (-218.142, 799.332), (124.179, 980.466),
                      (-120.440, 986.740), (106.139, 996.090), (353.907, 994.890),
                      (348.495, 1011.685), (330.116, 1000.187), (339.587, 985.052),
                      (366.197, 1007.999), (325.380, 1019.619), (357.853, 1030.556),
                      (367.099, 974.409), (340.827, 1033.656), (311.173, 999.797),
                      (331.018, 966.597), (378.825, 1025.576), (349.960, 956.832),
                      (390.326, 996.184), (305.169, 1017.807), (313.879, 1033.387),
                      (371.919, 1042.413), (304.859, 972.065), (296.515, 988.372),
                      (395.062, 976.752), (368.903, 949.802), (332.596, 946.189),
                      (386.718, 961.812), (327.410, 1052.526), (363.491, 1057.213),
                      (404.082, 1016.201), (307.339, 954.001), (354.245, 938.377),
                      (285.691, 1018.057), (302.153, 1047.839), (395.964, 1043.152),
                      (346.352, 1066.196), (284.112, 971.284), (277.798, 994.329),
                      (414.907, 989.642), (411.749, 972.554), (384.801, 938.060),
                      (401.376, 951.364), (337.332, 926.757), (282.195, 1039.515),
                      (270.328, 1010.654), (423.025, 1015.420), (383.110, 1069.614),
                      (362.589, 922.070), (321.095, 1075.571), (295.500, 935.326),
                      (309.369, 924.414), (287.720, 1060.338), (410.396, 1055.651),
                      (262.548, 982.361), (278.700, 946.677), (426.407, 1032.118),
                      (266.861, 965.303), (371.609, 1083.382), (432.045, 979.096),
                      (401.179, 929.363), (256.826, 999.309), (328.988, 911.817),
                      (436.443, 1004.362), (260.434, 1027.431), (415.809, 938.865),
                      (300.123, 1080.551), (265.169, 1045.495), (388.748, 916.602),
                      (338.234, 1093.147), (365.069, 904.006), (430.016, 949.314),
                      (343.646, 901.369), (443.772, 1020.889), (286.818, 918.946),
                      (391.454, 1090.803), (441.065, 962.301), (355.457, 1101.490),
                      (409.043, 1082.308), (270.582, 1070.884), (242.619, 988.860),
                      (298.967, 906.172), (451.890, 996.672), (437.345, 1055.138),
                      (375.894, 1102.423), (281.406, 1086.507), (404.759, 908.693),
                      (237.206, 1005.656), (246.227, 954.489), (420.657, 917.945),
                      (242.957, 1042.151), (339.136, 1111.504), (258.855, 929.101),
                      (310.947, 1107.110), (454.596, 1036.512), (293.696, 1101.325),
                      (325.605, 887.308), (358.868, 885.233), (390.101, 892.874),
                      (307.903, 890.604), (249.835, 1065.415), (433.624, 1077.426),
                      (267.875, 912.306), (460.008, 968.941), (282.082, 900.881),
                      (443.433, 932.201), (464.518, 1013.467), (455.272, 950.876),
                      (226.382, 1021.279), (224.465, 989.520), (227.961, 968.062),
                      (469.339, 993.981), (339.812, 875.883), (253.217, 1082.113),
                      (380.629, 1120.488), (397.655, 1114.507), (440.051, 915.308),
                      (420.319, 897.073), (372.286, 874.321), (419.868, 1105.743),
                      (263.365, 1100.568), (472.045, 1035.383), (239.349, 924.975),
                      (352.666, 1130.643), (308.805, 1125.736), (458.881, 1068.052),
                      (224.352, 1050.866), (325.944, 1131.205), (280.504, 1118.144),
                      (271.258, 886.820), (457.302, 921.289), (229.088, 1068.931),
                      (358.079, 863.873), (437.457, 1102.912), (285.916, 876.372),
                      (212.513, 1032.191), (251.639, 899.416), (223.676, 936.522),
                      (209.131, 1015.298), (393.258, 869.341), (480.755, 965.425),
                      (484.137, 982.123), (207.439, 995.500), (485.829, 1000.554),
                      (473.877, 942.161), (455.385, 1089.510), (477.147, 1054.479),
                      (417.613, 1122.831), (339.953, 1142.745), (422.799, 879.008),
                      (299.447, 864.654), (381.080, 1140.896), (202.704, 977.436),
                      (378.008, 857.373), (489.775, 1029.091), (229.990, 910.353),
                      (206.425, 955.148), (446.478, 891.605), (242.393, 1105.548),
                      (316.585, 854.108), (258.291, 1121.049), (210.145, 1062.291),
                      (411.975, 863.385), (288.622, 1141.189), (498.795, 1012.296),
                      (401.151, 1143.044), (341.842, 846.297), (468.126, 905.666),
                      (482.474, 1073.612), (318.164, 1152.418), (212.852, 920.899),
                      (473.539, 1088.850), (199.096, 1049.304), (283.746, 857.080),
                      (267.847, 1135.934), (189.737, 1017.935), (501.502, 970.894),
                      (260.659, 866.998), (348.607, 1158.082), (188.046, 999.113),
                      (220.970, 1096.662), (368.677, 1157.105), (496.089, 945.505),
                      (422.940, 1139.621), (445.576, 1125.175), (365.633, 840.609),
                      (440.163, 867.779), (491.354, 927.441), (234.500, 881.840),
                      (221.421, 894.827), (497.781, 1065.293), (195.487, 932.128),
                      (201.125, 1079.086), (402.278, 843.953), (458.204, 877.153),
                      (184.889, 1038.855), (513.002, 1000.871), (383.335, 837.313),
                      (469.705, 1113.360), (513.933, 982.874), (178.123, 982.318),
                      (396.866, 1161.499), (424.829, 849.421), (509.620, 1046.667),
                      (205.523, 904.372), (305.282, 1165.131), (415.583, 1155.543),
                      (283.097, 1158.643), (322.899, 1170.483), (246.001, 1139.920),
                      (517.738, 1018.936), (179.476, 955.661), (173.839, 1008.683),
                      (440.840, 1144.607), (487.746, 1099.299), (228.186, 1126.347),
                      (264.267, 1152.907), (480.670, 889.646), (273.288, 841.610),
                      (501.163, 1082.186), (289.299, 833.700), (192.105, 915.430),
                      (240.815, 858.795), (518.640, 960.348), (350.045, 1176.873),
                      (513.115, 939.525), (314.556, 824.326), (459.191, 1138.205),
                      (256.713, 845.491), (170.259, 1029.353), (222.774, 868.169),
                      (180.829, 1072.544), (335.528, 819.346), (475.343, 872.856),
                      (397.542, 825.888), (378.713, 1179.344), (515.032, 1071.274),
                      (170.456, 1051.354), (526.420, 1035.316), (178.236, 926.342),
                      (461.474, 855.646), (530.902, 1002.769), (498.570, 894.632),
                      (202.929, 1116.973), (415.442, 827.786), (183.987, 1089.632),
                      (357.177, 814.659), (531.043, 980.561), (160.534, 990.813),
                      (413.103, 1173.608), (480.529, 1128.983), (201.576, 881.156),
                      (294.936, 1180.638), (296.825, 817.924), (516.611, 918.067),
                      (157.828, 1016.592), (165.044, 943.162), (272.386, 1175.170),
                      (444.448, 836.825), (507.816, 1100.959), (213.528, 1136.795),
                      (431.481, 1171.044), (365.295, 1190.403), (497.893, 1117.754),
                      (377.021, 809.582), (343.421, 1193.039), (533.073, 947.849),
                      (401.968, 1187.174), (540.289, 1024.404), (183.085, 1108.770),
                      (249.609, 829.013), (152.190, 969.624), (164.142, 1076.742),
                      (266.973, 817.784), (538.259, 1053.991), (151.513, 1042.761),
                      (487.069, 858.405), (453.694, 1168.139), (386.042, 1195.871),
                      (155.798, 1061.802), (503.306, 875.200), (546.941, 996.062),
                      (518.753, 897.146), (244.423, 1172.826), (311.624, 1197.922),
                      (535.328, 930.761), (224.127, 1160.035), (527.435, 1088.362),
                      (471.735, 1158.765), (417.697, 810.503), (535.779, 1072.055),
                      (433.849, 817.003), (419.191, 1189.915), (142.578, 984.314),
                      (287.833, 1197.116), (191.541, 1135.501), (547.956, 956.149),
                      (476.921, 839.950), (459.106, 826.377), (552.015, 975.581),
                      (494.736, 1144.411), (206.876, 1153.077), (225.818, 828.891),
                      (267.650, 1194.602), (134.149, 1003.996), (556.413, 1033.265),
                      (227.284, 1177.123), (559.908, 1011.807), (238.785, 813.390),
                      (131.669, 1022.060), (465.420, 1181.810), (452.341, 1194.797),
                      (465.279, 809.527), (238.108, 1198.996), (574.566, 1001.359),
                      (695.751, 803.796), (673.877, 799.988), (711.199, 795.716),
                      (681.883, 783.314), (687.295, 821.982), (712.890, 815.123),
                      (703.531, 775.503), (724.616, 785.048), (659.670, 780.361),
                      (669.254, 831.357), (653.018, 802.063), (671.171, 766.397),
                      (732.396, 806.750), (694.962, 843.758), (724.278, 833.700),
                      (695.413, 752.458), (723.827, 762.516), (646.252, 819.151),
                      (744.687, 787.196), (640.840, 785.951), (710.748, 852.058),
                      (746.068, 820.170), (665.646, 748.552), (648.959, 760.563),
                      (674.666, 856.745), (649.410, 842.684), (716.160, 740.741),
                      (628.212, 798.840), (742.770, 755.876), (759.908, 801.574),
                      (754.045, 770.816), (743.221, 847.371), (703.982, 869.146),
                      (630.918, 833.993), (729.831, 860.400), (631.369, 763.004),
                      (691.354, 728.144), (662.404, 731.605), (759.457, 834.481),
                      (618.741, 814.171), (684.955, 877.293), (770.282, 818.858),
                      (634.977, 855.182), (709.874, 720.839), (739.613, 733.319),
                      (613.328, 778.627), (613.751, 830.862), (607.888, 799.322),
                      (770.648, 764.414), (645.350, 871.489), (779.302, 786.439),
                      (666.548, 883.695), (645.801, 725.508), (614.343, 759.757),
                      (726.984, 881.352), (757.653, 859.869), (685.138, 711.849),
                      (781.318, 805.029), (763.066, 745.428), (745.025, 871.977),
                      (625.957, 737.616), (666.097, 712.521), (726.533, 714.864),
                      (707.140, 892.679), (599.347, 817.588), (787.449, 822.001),
                      (685.491, 897.366), (782.910, 839.559), (698.119, 700.120),
                      (602.504, 844.246), (617.951, 870.684), (589.876, 795.423),
                      (745.476, 889.066), (749.676, 712.368), (623.843, 719.301),
                      (681.573, 694.304), (798.696, 808.605), (788.322, 753.239),
                      (593.484, 761.051), (799.147, 787.611), (606.112, 736.444),
                      (771.325, 873.290), (637.232, 893.753), (658.853, 696.110),
                      (637.683, 702.463), (698.909, 912.672), (737.809, 904.787),
                      (803.770, 768.741), (766.674, 711.056), (667.450, 914.551),
                      (786.518, 728.632), (597.092, 868.853), (586.718, 851.569),
                      (791.931, 864.166), (573.639, 812.999), (643.997, 909.474),
                      (573.188, 783.998), (811.775, 820.811), (725.631, 683.227),
                      (717.964, 919.238), (609.720, 889.554), (808.618, 841.024),
                      (672.862, 678.247), (601.856, 715.957), (615.132, 703.244),
                      (786.941, 880.857), (746.829, 688.011), (572.624, 834.554),
                      (817.187, 784.486), (775.694, 894.241), (818.879, 804.479),
                      (650.424, 680.078), (803.544, 734.564), (577.698, 741.034),
                      (705.336, 670.435), (692.707, 930.175), (633.173, 682.934),
                      (765.321, 909.767), (817.638, 751.579), (628.353, 918.500),
                      (764.419, 685.570), (644.448, 926.562), (586.267, 884.476),
                      (556.613, 809.752), (561.011, 764.176), (580.855, 720.821),
                      (608.818, 908.693), (683.687, 662.623), (673.229, 936.272),
                      (556.021, 780.867), (572.850, 868.731), (828.012, 768.863),
                      (747.872, 927.581), (740.627, 669.141), (804.108, 883.988),
                      (555.598, 828.622), (663.842, 661.452), (804.559, 713.009),
                      (587.959, 704.489), (793.735, 698.948), (598.896, 691.136),
                      (714.807, 942.576), (793.284, 904.298), (824.404, 861.041),
                      (734.201, 939.158), (557.402, 853.229), (635.428, 666.041),
                      (840.189, 807.433), (768.478, 927.050), (544.774, 794.251),
                      (840.640, 789.564), (837.032, 836.434), (654.822, 943.845),
                      (728.788, 653.640), (833.424, 744.256), (616.936, 931.737),
                      (607.916, 673.560), (568.227, 887.601), (785.955, 920.972),
                      (756.300, 660.963), (551.990, 739.569), (545.380, 756.742),
                      (696.315, 645.828), (540.405, 773.300), (567.776, 708.615),
                      (680.079, 954.782), (596.979, 922.827), (575.894, 903.127),
                      (773.890, 665.748), (556.529, 722.011), (535.754, 811.046),
                      (637.119, 947.922), (794.186, 678.540), (848.871, 770.694),
                      (820.796, 895.413), (701.727, 959.469), (761.712, 944.138),
                      (830.267, 717.598), (717.316, 640.964), (820.344, 700.803),
                      (854.763, 819.291), (845.263, 859.747), (746.040, 643.753),
                      (778.823, 941.007), (648.057, 640.653), (747.280, 956.637),
                      (539.728, 864.404), (579.953, 677.466), (844.671, 730.872),
                      (532.146, 845.418), (620.545, 648.953), (725.180, 964.546),
                      (860.175, 786.091), (604.674, 656.612), (548.382, 886.429),
                      (856.877, 837.606), (667.901, 633.232), (844.248, 878.617),
                      (703.419, 629.497), (526.733, 759.879), (550.398, 705.039),
                      (660.234, 969.233), (685.463, 973.133), (796.892, 938.670),
                      (539.362, 718.868), (813.579, 925.097), (518.756, 812.358),
                      (630.016, 964.058), (730.592, 628.252), (868.603, 802.453),
                      (797.343, 658.327), (685.942, 623.858), (611.524, 956.344),
                      (838.808, 899.312), (528.537, 734.491), (558.755, 915.235),
                      (702.178, 976.557), (575.443, 932.909), (772.086, 641.141),
                      (559.206, 681.762), (514.556, 789.076), (849.661, 714.181),
                      (865.897, 755.192), (587.620, 946.482), (813.227, 665.370),
                      (831.620, 915.723), (514.105, 771.987), (862.289, 862.994),
                      (545.112, 904.567), (826.208, 677.075), (861.838, 734.003),
                      (782.008, 958.688), (588.071, 650.515), (753.143, 627.471),
                      (523.125, 870.806), (603.970, 638.773), (841.429, 691.209),
                      (568.255, 663.813), (647.606, 620.440), (876.270, 771.499),
                      (876.721, 825.498), (620.996, 628.545), (790.437, 641.306),
                      (508.693, 833.309), (512.301, 747.381), (539.700, 690.135),
                      (750.437, 980.170), (511.850, 855.866), (770.169, 972.822),
                      (676.471, 989.153), (721.572, 611.457), (700.262, 609.284),
                      (616.147, 974.970), (642.193, 984.857), (522.871, 710.366),
                      (557.741, 936.986), (885.629, 797.839), (741.417, 612.628),
                      (676.019, 607.063), (712.552, 993.840), (855.073, 908.302),
                      (799.175, 963.783), (880.330, 742.694), (818.991, 950.485),
                      (879.879, 860.553), (860.485, 696.995), (781.106, 623.565),
                      (496.064, 781.362), (495.613, 814.854), (694.849, 997.917),
                      (818.540, 646.512), (871.760, 885.941), (566.986, 645.413),
                      (733.411, 995.671), (551.088, 658.718), (877.172, 719.161),
                      (853.156, 677.539), (655.865, 998.277), (806.363, 632.939),
                      (595.288, 977.045), (566.423, 958.297), (893.324, 831.595),
                      (624.153, 608.332), (492.118, 760.636), (841.993, 939.842),
                      (897.017, 812.511), (897.468, 783.705), (600.700, 615.753),
                      (790.126, 981.732), (582.659, 625.127), (629.565, 996.965),
                      (842.444, 656.374), (760.810, 996.477), (896.115, 753.923),
                      (771.071, 606.452), (896.566, 848.542), (574.654, 976.923),
                      (810.873, 977.436), (478.813, 798.621), (478.954, 820.829),
                      (826.659, 970.698), (907.715, 769.461), (602.391, 998.210),
                      (821.810, 623.443), (786.039, 998.814), (914.494, 816.587),
                      (916.411, 797.376), (808.956, 608.405), (803.798, 995.152),
                      (578.713, 604.402), ])


LATTICE_VECTORS = {
    'a1': np.array([230.92, 0.0]),
    'a2': np.array([-115.46, 199.98]),
}
HEXAGON_SIDE = np.linalg.norm(LATTICE_VECTORS['a1'])


def hexagon(hexagon_side=HEXAGON_SIDE):
    '''make central column hexagon'''
    angles = np.arange(6 + 1) * ((2 * np.pi) / 6)
    points = hexagon_side * np.array([np.cos(angles), np.sin(angles)]).transpose()
    return points


def get_virtual_fiber_locations(apron_size=0.0):
    '''get locations in bounding box of central column'''
    points = hexagon()
    mean_locations = np.mean(LOCATIONS, axis=0)
    min_xz = np.min(points, axis=0) + mean_locations - apron_size
    max_xz = np.max(points, axis=0) + mean_locations + apron_size

    idx = np.all((min_xz <= LOCATIONS) & (LOCATIONS <= max_xz), axis=1)
    return LOCATIONS[idx]


def tiled_locations(voxel_size, hull=None):
    '''create grid spanning the bounding box of the central minicolum

    Can pass in hull to filter the returned points:

    >>> from scipy.spatial import Delaunay
    >>> h = hexagon()
    >>> hull = Delaunay(h)

    '''
    locations = get_virtual_fiber_locations()

    min_x, min_z = np.min(locations, axis=0).astype(int)
    max_x, max_z = np.max(locations, axis=0).astype(int)

    x = np.arange(min_x, max_x + voxel_size, voxel_size)
    z = np.arange(min_z, max_z + voxel_size, voxel_size)

    grid = np.vstack(np.transpose(np.meshgrid(x, z)))

    if hull is not None:
        grid_at_origin = grid - np.mean(grid, axis=0)
        grid = grid[hull.find_simplex(grid_at_origin) >= 0]

    return grid


def voxel_space(voxel_size_um=VOXEL_SIZE_UM):
    '''returns VoxelData with the densities from `distmap`

    This is a 'stack' of (x == z == y == voxel_size) voxels stacked to
    the full y-height of the hexagon.  It can then be tiled across a whole
    space to get the desired density.

    Args:
        distmap: list of results of recipe_to_height_and_density()
        voxel_size(int): in um
    '''
    xz_extent = 1
    shape = (xz_extent, int(sscx.LAYER_BOUNDARIES[-1] // voxel_size_um), xz_extent)
    raw = np.zeros(shape=shape, dtype=np.int)

    tiles = tiled_locations(voxel_size_um)
    n_tile_x, n_tile_y = (tiles.max(axis=0) -
                          tiles.min(axis=0)) / voxel_size_um
    raw = raw.repeat(n_tile_x, axis=0).repeat(n_tile_y, axis=2)
    return VoxelData(raw, [voxel_size_um] * 3, (tiles[:, 0].min(), 0, tiles[:, 1].min()))


def get_minicol_virtual_fibers(apron_size):
    """returns Nx6 matrix: first 3 columns are XYZ pos of fibers, last 3 are direction vector"""

    fibers = set(tuple(loc) for loc in get_virtual_fiber_locations())
    extra_fibers = set(tuple(loc) for loc in get_virtual_fiber_locations(apron_size)) - fibers

    def to_dataframe(points, outsider):
        '''return fibers in a dataframe'''
        df = pd.DataFrame(columns=XYZUVW + ['apron'])
        if not points:
            return df
        df.x, df.z = zip(*points)
        df.v = 1  # all direction vectors point straight up
        df.apron = outsider
        return df.fillna(0)

    return pd.concat((to_dataframe(fibers, False), to_dataframe(extra_fibers, True)))
